
# JavaScript 基礎［４］（関数）

* JavaScript基礎

<section class="contenttextsection">

## 概要

プログラミングにおいて欠かすことのできない概念に **関数** があります。

関数というと、学生時代に勉強した二次関数みたいなものを思い浮かべる方もいらっしゃるかもしれませんが、プログラミングにおける関数はそれとは違うものですね。

関数がどういうものか、またどういうふうに便利なのかがわかってくると、プログラミングの本質的なスキルである「達成したい目的に応じて処理を分類・整理する」ということができるようになってきます。どのようなプログラミング言語を勉強する場合でも、大抵は関数の概念が登場します。ここでしっかりと、その基本を身に着けておきましょう。

## 関数を定義する

関数を利用するには、最初にまず **関数を定義する** 必要があります。

最も基本的な関数の定義は、たとえば次のように行います。

</section>

<section class="contentcodesection"><div class="codesectionleft">

```
// 関数を定義する
function FUNC(){
    console.log('関数 FUNC が呼び出されました');
}
```

</div><div class="codesectionright">

まず行の一番最初の部分に `function` と記述します。

これが、関数を定義するためのコードの記述を開始しますよ～ というサインになっています。そして、その `function` に続けて半角スペースをひとつ空け、関数の名前を書いてやります。続いて出てくる `()` の手前までが関数の名前になります。

</div></section>

<section class="contenttextsection">

関数の名前は基本的に自由に命名することができます。

ただし「JavaScript であらかじめ定義されている名前」や、いくつかある「関数定義のルールに則していない名前」は定義できません。

JavaScript であらかじめ定義されている名前、というのは別名 **予約語** とも言います。予約語は、その名のとおり既に名前が JavaScript の仕様上で予約されているので、同じ名前の関数を作ることはできないわけですね。

JavaScript の予約語には以下のような種類があります。あくまでも JavaScript の予約語なので、他のプログラミング言語ではここに掲載したもの以外の予約語があったりすることも当然あり得ます。

#### JavaScript の予約語

```
* break * case * catch * const * continue * debugger * default * delete * do * else * enum * export * extends * false * finally * for * function * if * import * in * instanceof * let * new * null * return * static * super * switch * this * throw * true * try * typeof * var * void * while * with
```

「いやいや覚えきれんやろ！」と思った方もいるかもしれませんが……

私も、全部の予約語を覚えているわけではありませんし、その必要もありません。これらの予約語は大抵はプログラミングをやっている間に何度も出てくることになるので、わざわざ暗記しなくても自然と分別ができるようになると思います。

そして予約語とは異なる名前であっても、次に示したルールに反する名前は、関数名に用いることはできません。

#### 関数名の命名規則

* 関数名に含めることができる記号は `_` または `$` だけ
* 関数名に数字を使うことはできるが先頭の文字には数字は使えない

#### 関数定義の「正しくない」例

```
// 使えない記号を使っている
function my-function(){
    // 関数実行時の処理
}
function my?function(){
    // 関数実行時の処理
}

// 数値が先頭の文字に使われている
function 1st(){
    // 関数実行時の処理
}
function 2nd(){
    // 関数実行時の処理
}
```

#### 関数定義の「正しい」例

```
// 正しい記号のみを使っている
function _my_function(){
    // 関数実行時の処理
}
// 記号を使っていない
function myFunction(){
    // 関数実行時の処理
}
// 数字を先頭に置いていない
function myFunction1st(){
    // 関数実行時の処理
}
```

また、関数の名前は **大文字と小文字が区別される** 点にも注意しましょう。

つまり、以下に示したふたつの関数はそれぞれまったく別の関数として定義されます。

#### 関数名は大文字と小文字が区別される

```
function myfunc(){
    // 関数実行時の処理
}

function myFunc(){
    // 関数実行時の処理
}
```

> ### キャメルケースとスネークケース
> 
> JavaScript では、関数の命名時に使える記号の種類が少なく、一般的に単語を区切るのに使われるような半角スペース、カンマ（ `,` ）やドット（ `.` ）、ハイフン（ `-` ）などは関数名に含ませることができません。
> 
> そこで、関数を命名するときに複数の単語を用いる場合は、なんらかの決まりごとに則ってそれらを組み合わせます。
> 
> 代表的な方法として「キャメルケース」と「スネークケース」をここでは紹介しましょう。
> 
> キャメルケースの「キャメル」は Camel（ラクダ）です。たとえば「my function」をキャメルケースで書くと `myFunction` となります。これはラクダの背中のコブのように山と谷（大文字と小文字）が連続するようなイメージといったら良いでしょうか…… 単語が切り替わる部分で、その単語の先頭の文字だけを大文字にするわけですね。「my original function」であれば `myOriginalFunction` という感じ。
> 
> 一方、スネークケースの「スネーク」は Snake（ヘビ）です。これも、キャメルケースと同様に、定義した関数名がヘビをイメージするような形になることから来ています。
> 
> スネークケースの場合は、単語の区切りの位置でアンダースコア（ `_` ）を使います。つまり「my function」をスネークケースで書くと `my_function` となりますね。一般に、スネークケースを使う場合はすべてのアルファベットが小文字になるか、逆にすべてが大文字になる場合が多いでしょう。先程のキャメルケース同様に「my original function」をスネークケースで書くと `my_original_function` という感じです。
> 
> これらの○○ケースと呼ばれる命名ルールは、プログラミング言語によっては「どのルールを使うか推奨されている」場合もあります。たとえば JavaScript の場合はキャメルケースを使う場合が多く、多くの場合は関数名は「小文字始まりのキャメルケース」で定義するのが一般的です。

## 関数を呼び出す

さて、関数を定義する方法はわかりましたが、まだ関数がどうして便利なのかはいまいちわかりにくいですね……

関数は、定義した段階では **まだ実行されません** 。

たとえば JavaScript のコードに次のように書いてあった場合、関数の「定義だけを行った状態」なので、JavaScript が実行されたとしても関数 `consoleOutput` の中に記述されている `console.log` は実行されません。

#### 関数の定義だけを行った状態

```
function consoleOutput(){
    // コンソールへの出力
    console.log('hello world!');
}

// 以下、特になにも処理を行っていない
```

つまり、関数はあくまでも「こういう処理を行いますよ～」ということを定義しているだけなので、別途 **これを実行するコード** を記述してやる必要があります。

関数を実行することを、一般に「関数を呼び出す」あるいは「関数を呼ぶ」と言うこともあります。

実際に、どうやって関数を呼び出すかというと **関数名に続けて丸括弧をつける** だけで OK です。丸括弧というのは `(` で始まり `)` で終わるカッコのことです。簡単ですね。

#### 関数を呼び出すコード

```
function consoleOutput(){
    // コンソールへの出力
    console.log('hello world!');
}

// 定義した関数の呼び出し
consoleOutput(); // → hello world!
```

関数は「定義をまず行い」、「呼び出すことで実行する」わけですね。

## 関数の引数

関数を呼び出したい場合は、丸括弧を関数名に続けて記述すればよいことがわかりました。

しかし、考えてみるとこの「関数名にくっつけた丸括弧」って、いったいなんのためのものなのでしょう。

実は、関数には **引数** と呼ばれる仕組みがあります。これは、関数を呼び出すときに「関数に対してデータを渡したいとき」に利用します。

具体的な例と共に考えてみましょう。

たとえば、あなたは毎日一杯３５０円のコーヒーを飲むのが日課だとします。ふと、年間でいくらコーヒーにつぎ込んでいるかを知りたくなりました。こんなとき、「任意の杯数のコーヒーの合計金額を計算してくれる関数」を定義することができたら、簡単に合計金額を算出することができます。

そこで次のようなコードを記述したと仮定してみましょう。

#### 合計価格算出関数

```
// 定義
function howMuchCoffee(){
    console.log( 350 * 365 );
}

// 呼び出し
howMuchCoffee(); // → 127750
```

一杯３５０円のコーヒーも、毎日飲み続けたら一年で１３万円弱くらいになるんですね……

さて、これで確かに当初の目的であった「年間でいくらコーヒーにつぎ込んでいるか」はわかりましたが、次にはふと、一ヶ月あたりだったらどうなんだろうということが気になったとします。

このときに、たとえばもうひとつ関数を新しく定義する、というのはあまり賢い方法とは言えません。実は、先程出てきた「関数の引数の仕組み」をうまく利用すれば、任意の日数に対して合計金額を算出できるように `howMuchCoffee` 関数を改造することができます。

たとえば次のようにすればよいでしょう。

#### 合計価格算出関数を改造する

```
// 定義（引数を受け取れるようにする）
function howMuchCoffee( day ){
    // 引数を使って処理を行う
    console.log( 350 * day );
}

// 呼び出し
howMuchCoffee( 31 ); // → 10850
```

このように、関数の名前に続ける `()` の部分を、データの受け渡しのための窓口として利用することで **関数に対して引数を渡す** ことができます。

関数が受け取った引数は、そのまま関数の内部で「引数と同じ名前をコードの一部として」利用することができます。

このように「引数を利用して汎用性を高めておく」ことで、関数がより便利に、様々なデータに対応する形へと進化するわけですね。

> ### 引数と言っても数値ばかりとは限らない
> 
> 関数は「数」という漢字を使っていますが数値というわけではありません。それと同様に、引数もまた「数」という漢字が使われていますが「数値とは限らない」ので注意しましょう。
> 
> 以前説明した JavaScript のデータ型には、数値以外にも文字列やオブジェクトなどがありましたが、それら任意のデータ型の値を引数としてやりとりできます。
> 
> ただし、JavaScript には「引数のデータ型を指定する方法は無い」ので、たとえば先程の例に登場した `howMuchCoffee` 関数のように「引数として数値が渡されてくる前提になっている関数」の場合、文字列や、あるいはオブジェクトなどを引数として渡されてしまうと、場合によってはエラーが出てしまう可能性もあります。
> 
> このあたりはやや難しい話になるのでここでは説明はしませんが、データ型によって処理を変化させたり、あるいは事前にデータ型をチェックしたりする方法についても、いずれ当サイトで解説する予定です。

## 関数の戻り値

さて、無事に「任意の日数に対するコーヒーの合計金額」が求められる関数を作ることはできましたが……

この関数は「呼び出すと同時に必ずコンソールへと出力してしまう」という作りになっています。

たとえば計算だけを先に行っておいて、その結果を別の処理にも活用したいといったケースが無いとも限りません。そこで、この `howMuchCoffee` 関数をさらに改造して関数の **戻り値** を定義してみましょう。

関数の戻り値とは、なんとなくその名前からもイメージしやすいかなと思いますが「関数を呼び出した結果として、呼び出し元に戻ってくる結果」のことです。これまでの `howMuchCoffee` 関数は、その内部でコンソールへの出力を行っているだけで、外部に対して「計算した結果を戻す仕組み」がありませんでした。しかし戻り値の仕組みを利用してやれば、計算した結果を呼び出し元に返してやることができます。

これは、言葉ではちょっとわかりにくいかなと思いますが、コードとして見てみるとわかりやすいかもしれません。

#### 合計価格を戻り値として返す

```
// 定義（戻り値を返すようにする）
function howMuchCoffee( day ){
    // return キーワードを使って戻り値を呼び出し元に返す
    return 350 * day;
}

// 呼び出した結果を、そのままコンソールへ出力
console.log( howMuchCoffee(10) ); // → 3500
```

関数に戻り値を定義したい場合は `return` キーワードを使います。

この `return` が実行されると、その時点で `return` に半角スペースを空けて書かれた内容が、この関数を呼び出している「呼び出し元のコード」に対して返却されます。

もしも `return` の後ろになにも記述していない、あるいはすぐにセミコロン（ `;` ）を記述している場合は `undefined` が返却されます。

先程のコードでは `console.log( howMuchCoffee(10) );` と書かれているので……

まず最初に `howMuchCoffee(10)` が実行されて、そこから `return` キーワードによって返却された戻り値が、コンソールへと出力されるわけですね。



## 無名関数

## 即時関数

## 関数とスコープ

## 関数のホイスティング（巻き上げ）

</section>
